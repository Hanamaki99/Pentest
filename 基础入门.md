# 基础入门

## 信息收集

### 域名

- 域名注册人信息收集
  - http://whois.chinaz.com
- 子域名爆破
  - 域传送漏洞
    - http://drops.wooyun.org/papers/64
  - 工具
    - dnsenum
    - layer子域名挖掘机
    - subDomainBrute
      - http://zone.wooyun.org/content/19492
    - wydomain
      - http://zone.wooyun.org/content/18058
- 如果目标网络使用cdn，如何绕过cdn找到目标ip网段
  - phpinfo()
  - http://zone.wooyun.org/content/79
  - http://zone.wooyun.org/content/652
  - http://zone.wooyun.org/content/18058



### 善用搜索引擎

- 搜索引擎
  - google.com
    - 利用google收集域名和mail地址    theHarvester神器
    - google_hack
      - 搜索敏感文件
        - site:xxx.com filetype:doc intext:pass
        - site:xxx.com filetype:xls intext:pass
        - site:xxx.com filetype:conf
        - site:xxx.com filetype:inc
        - ……
      - 搜索管理后台
        - site:xxx.com 管理
        - site:xxx.com admin
        - site:xxx.com login
      - 搜索mail
        - site:xxx.com intext:@xxx.com
        - intext:@xxx.com
      - 搜索敏感web路径
        - site:xxx.com intitle:mongod inurl:28017
        - site:xxx.com inurl:sql.php
        - site:xxx.com inurl:phpinfo.php
      - 资料
        - http://zone.wooyun.org/content/19386
  - bing.com
  - sogou.com
- 网络组件搜索
  - shodanhq.com
  - zoomeye.com
  - www.fofa.com



## ASP环境快速搭建





## HTTP请求数据包

一个请求由四个部分组成



- 请求行
- 请求头标
- 空行
- 数据格式



### 请求行

请求行由三个标记组成，用空格分隔



- 请求方法
- 请求URI
- HTTP版本



8种可能请求的方法（最常用的三种）



- GET	检索URI中标识资源的一个简单请求
- POST    服务器接受被写入客户端输出流中的数据的请求
- PUT    服务器保存请求数据作为指定URI新内容的请求



### 请求头标

由关键字/值对组成，每行一对，关键字和值用冒号（:）分隔

请求头标通知服务器有关于客户端的功能和标识，典型的请求头标



- User-Agent    客户端厂家和版本
- Accept    客户端可识别的内容类型列表
- Content-Length    附加到请求的数据字节数



### 空行

最后一个请求之后是一个空行，发送回车符和退行，通知服务器以下不再有头标



### 请求数据

使用POST传送数据，最常使用的是



- Content-Type
- Content-Length



## HTTP响应数据包

Web服务器解析请求，定位指定资源。服务器将资源副本写至套接字，在此处由客户端读取

一个响应由四个部分组成



- 状态行
- 响应头标
- 空行
- 响应数据



### 状态行

三个标记组成



- HTTP版本：向客户端指明可理解的最高版本
- 响应代码：3位的数字代码，指出请求的成功或失败，如果失败则指出原因
- 响应描述：为响应代码的可读性解释



常见HTTP响应码（目录爆破工具实现原理）



- 200：文件存在
- 403：文件夹存在
- 404：文件或文件夹不存在
- 500：文件或文件夹不一定存在，服务器错误
- 3xx：文件或文件夹不一定存在，重定向，为了完成请求，必须进一步执行的动作



> 安全狗WAF拦截请求后也返回200



根据状态码返回，可以进行目录信息收集（找后台等）



## Google搜索

> 语法各大搜索引擎基本上大同小异



### 基本符号



- ""：完全匹配搜索，不会拆分关键词
- +：指定一个一定存在的关键词
- -：排除一个关键词
- |：多个条件满足其一就可
- AND：多个条件同时满足



### site搜索语法



site：搜索指定域名下的结果



作用



- 可以针对目标做一个准确的信息收集（目录、文件）
- 得到目标的子域名



### inurl搜索语法



 一般用于批量搜索较多



- 找后台
- 找注入点
- 找指定漏洞目标站点



### intitle搜索



### cache缓存搜索



### 拓展玩法




## 基本工具


###  文本遍历工具-Tommsearch

> 批量文件内容搜索
>
> （代码审计、源码修改）



应用示例



- 文件名：*.php  关键字：seclect
- 文件名：（空） 关键字：logo



### 数据库监控工具-seay代码审计系统集成

> 可以看到MySQL数据库真实执行的语句



审计插件-Mysql监控

可以结合文本遍历工具定位出现SQL注入的位置



## Web安全架构分析及思路拓展

> 这个章节是为了干嘛？



Web组成架构：



- 操作系统：空地        windows、mac、linux
- 搭建平台：房子        iis、apache、tomcat、nginx
- 脚本语言：材质        asp、php、aspx、jsp
- 数据库：仓库            mysql、sqlserver、oracle



问题：



- 漏洞产生层面？
- 漏洞产生意义？
- 漏洞如何发现？
- 漏洞如何利用？



大小写敏感



- Windows大小写不敏感
- Linux大小写敏感



探侦架构的方法



- 查看元素
- 搜索引擎
- 扫描爬虫
- 找相关应用（搜索等特定功能）



探侦数据库



- 端口扫描
- 组合判断
  - linux不存在asp、aspx
  - linux不存在iis
  - asp+access
  - php+mysql
  - aspx+mssql
  - jsp+mssql oracle
  - windows+asp+access+iis





































